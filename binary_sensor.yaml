- platform: command_line
  command: '/home/hass/.homeassistant/cmds/tomato_smb_check'
  name: 'smb online'
  device_class: connectivity
  payload_on: "success"
  payload_off: "fail"
  scan_interval: 600

- platform: template
  sensors:
    isp_conn:
      entity_id:
        - sensor.ping_isp
      device_class: connectivity
      value_template: >-
        {%- if states.sensor.ping_isp.state == 'n/a' or
          states.sensor.ping_isp.state | float > 150 -%}
          False
        {%- else -%}
          True
        {%- endif %}
    batts_low:
      entity_id:
        - sensor.dht22_176e41_battery
        - sensor.bme280_171f93_battery
        - sensor.root_battery
        #- input_number.slider_batt_level_p
        #- input_number.slider_batt_level_v
      device_class: power
      value_template: >-
        {%- if states.sensor.dht22_176e41_battery.state and
                states.sensor.bme280_171f93_battery.state -%}
          {%- if
            states.sensor.dht22_176e41_battery.state|float <= states.input_number.slider_batt_level_v.state|float or
            states.sensor.bme280_171f93_battery.state|float <= states.input_number.slider_batt_level_v.state|float or
            states.sensor.root_battery.state|float <= states.input_number.slider_batt_level_p.state|float -%}
            True
          {%- else -%}
            False
          {%- endif %}
        {%- else -%}
          True
        {%- endif %}

- platform: esp_wd
  name: x1
  host: !secret esp_host_x1
  scan_interval: 300
